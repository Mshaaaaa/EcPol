Name: Trifonova Maria
Explore the Data
Box 1:
colnames(gss_data)
Question 1
Box 1:
gss_data %>% filter(gender == "men") %>% summarise(wtd.mean = wtd.mean(earnings, weights = wgt, na.rm =
TRUE))
Box 2:
gss_data %>% filter(gender == "women") %>% summarise(wtd.mean = wtd.mean(earnings, weights = wgt, na.rm =
TRUE))
Question 2
Box 1:
gss_data %>% filter(gender == "men", child == 0) %>% summarise(wtd.mean = wtd.mean(earnings, weights = wgt,
na.rm = TRUE))
Box 2:
gss_data %>% filter(gender == "women", child == 0) %>% summarise(wtd.mean = wtd.mean(earnings, weights = wgt,
na.rm = TRUE))
Box 3:
gss_data %>% filter(gender == "men", child == 1) %>% summarise(wtd.mean = wtd.mean(earnings, weights = wgt,
na.rm = TRUE))
Box 4:
gss_data %>% filter(gender == "women", child == 1) %>% summarise(wtd.mean = wtd.mean(earnings, weights = wgt,
na.rm = TRUE))
Question 3
Box 1:
gss_data %>%
group_by(year_around_birth, gender) %>%
dplyr::summarize(avg_earnings = wtd.mean(earnings, weights = wgt, na.rm = TRUE)) %>%
ggplot(aes(year_around_birth, avg_earnings, color = gender)) +
geom_line() +
labs(title = "Earnings around Year of Child Birth",
x = "Years around Birth of First Child",
y = "Average Earnings",
color = "Gender") +
geom_vline(xintercept = 0)
Question 4
Box 1:
reg <- lm(formula = earnings ~ child*gender, data = gss_data)
summary(reg)
Box 2:
reg <- lm(formula = earnings ~ child*gender, data = gss_data)
gss_data %>%
group_by(year_around_birth, gender) %>%
dplyr::summarize(avg_earnings = wtd.mean(earnings, weights = wgt, na.rm = TRUE)) %>%
ggplot(aes(year_around_birth, avg_earnings, color = gender)) +
geom_line() +
labs(title = "Earnings around Year of Child Birth",
x = "Years around Birth of First Child",
y = "Average Earnings",
color = "Gender") +
geom_vline(xintercept = 0) +
annotate(geom="text", x = 2.5, y = 0.85, label =
paste("Estimate:", signif(summary(reg)[["coefficients"]][4], 4), "Än",
"SE:", signif(summary(reg)[["coefficients"]][8], 4)))
Question 5
Box 1:
reg <- gss_data %>%
filter(child_birth_year == 1980) %>%
lm(formula = employed ~ child*gender)
gss_data %>%
filter(child_birth_year == 1980) %>%
group_by(year_around_birth, gender) %>%
dplyr::summarize(avg_employed = wtd.mean(employed, weights = wgt, na.rm = TRUE)) %>%
ggplot(aes(year_around_birth, avg_employed, color = gender)) +
geom_line() +
labs(title = "Employment around Year of Child Birth - Parents of children born in 1980",
x = "Years around Birth of First Child",
y = "Average Employment Rates",
color = "Gender") +
geom_vline(xintercept = 0) +
ylim(0.5,1) +
annotate(geom="text", x = 2.5, y = 0.85, label =
paste("Estimate:", signif(summary(reg)[["coefficients"]][4], 4), "Än",
"SE:", signif(summary(reg)[["coefficients"]][8], 4)))
Box 2:
reg <- gss_data %>%
filter(child_birth_year == 2015) %>%
lm(formula = employed ~ child*gender)
gss_data %>%
filter(child_birth_year == 2015) %>%
group_by(year_around_birth, gender) %>%
dplyr::summarize(avg_employed = wtd.mean(employed, weights = wgt, na.rm = TRUE)) %>%
ggplot(aes(year_around_birth, avg_employed, color = gender)) +
geom_line() +
labs(title = "Employment around Year of Child Birth - Parents of children born in 2015",
x = "Years around Birth of First Child",
y = "Average Employment Rates",
color = "Gender") +
geom_vline(xintercept = 0) +
ylim(0.5,1) +
annotate(geom="text", x = 2.5, y = 0.85, label =
paste("Estimate:", signif(summary(reg)[["coefficients"]][4], 4), "Än",
"SE:", signif(summary(reg)[["coefficients"]][8], 4)))
Question 6
Box 1:
child_penalty_df %>%
ggplot(aes(year, child_penalty)) +
geom_point() +
labs(title = "Child Penalty as a function of Time",
x = "Time",
y = "Child Penalty")
Question 7
Box 1:
# NOTE - box 1 is not an answer, it’s me exploring the data with the variables I want to test. The actual
responses are in the boxes 2 (for Figure 2) and 3 (for Figure 3)
gss_data$marital_status <- as.factor(gss_data$marital_status)
reg <- lm(formula = earnings ~ child*marital_status, data = gss_data)
gss_data %>%
group_by(year_around_birth, marital_status) %>%
dplyr::summarize(avg_earnings = wtd.mean(earnings, weights = wgt, na.rm = TRUE)) %>%
ggplot(aes(year_around_birth, avg_earnings, color = marital_status)) +
geom_line() +
labs(title = "Earnings around Year of Child Birth",
x = "Years around Birth of First Child",
y = "Earnings Rate",
color = "marital_status") +
geom_vline(xintercept = 0) +
annotate(geom="text", x = 2.5, y = 0.85, label =
paste("Estimate:", signif(summary(reg)[["coefficients"]][4], 4), "Än",
"SE:", signif(summary(reg)[["coefficients"]][8], 4)))
Box 2:
gss_data$marital_status <- as.factor(gss_data$marital_status)
om_data <- gss_data %>% filter(marital_status == 1&2&4&5)
reg <- lm(formula = earnings ~ child*gender, data = om_data)
om_data %>%
group_by(year_around_birth, gender) %>%
dplyr::summarize(avg_earnings = wtd.mean(earnings, weights = wgt, na.rm = TRUE)) %>%
ggplot(aes(year_around_birth, avg_earnings, color = gender)) +
geom_line() +
labs(title = "Earnings around Year of Child Birth for single parents",
x = "Years around Birth of First Child",
y = "Average Earnings",
color = "gender") +
geom_vline(xintercept = 0) +
annotate(geom="text", x = 2.5, y = 0.85, label =
paste("Estimate:", signif(summary(reg)[["coefficients"]][4], 4), "Än",
"SE:", signif(summary(reg)[["coefficients"]][8], 4)))
Box 3:
gss_data$marital_status <- as.factor(gss_data$marital_status)
im_data <- gss_data %>% filter(marital_status == 3)
reg <- lm(formula = earnings ~ child*gender, data = im_data)
im_data %>%
group_by(year_around_birth, gender) %>%
dplyr::summarize(avg_earnings = wtd.mean(earnings, weights = wgt, na.rm = TRUE)) %>%
ggplot(aes(year_around_birth, avg_earnings, color = gender)) +
geom_line() +
labs(title = "Earnings around Year of Child Birth for both parents present",
x = "Years around Birth of First Child",
y = "Average Earnings",
color = "gender") +
geom_vline(xintercept = 0) +
annotate(geom="text", x = 2.5, y = 0.85, label =
paste("Estimate:", signif(summary(reg)[["coefficients"]][4], 4), "Än",
"SE:", signif(summary(reg)[["coefficients"]][8], 4)))